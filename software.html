<!DOCTYPE html>
<html lang="en-US">
	<head>
		<meta name="description" content="Matthew Wolak's software.">
		<title>Wolak: Software</title>
	        <!-- link to main stylesheet -->
		<link rel="stylesheet" type="text/css" href="/css/main.css">
	</head>

	<nav id="main-nav">
    		  <ul>
        		<li><a href="/">Home</a></li>
        		<li><a href="/research">Research</a></li>
        		<li><a href="/software">Software</a></li>
        		<li><a href="/cv">CV</a></li>
    		  </ul>
	</nav>



	<body>
                <div class="container" id="headline1">
                  <img src="images/DSC04680_crop.jpg" alt="Matthew Beartooth snowshoe"> 
                </div>
		<div class="container">
    		<div class="blurb">


        	<h1>Matthew Wolak's software</h1>



		  <h2>Repeatability</h2>

		    <h4><span class="code">R</span> package <span class="code">ICC</span></h4>

                  <div class="left-img" style="width: auto;">
<embed src="http://cranlogs.r-pkg.org/badges/last-day/ICC">
<br>
<embed src="http://cranlogs.r-pkg.org/badges/ICC">
<br>
<embed src="http://cranlogs.r-pkg.org/badges/grand-total/ICC"> 
 		    <div class="dropdown-contentL">
    		      <div class="img-desc">Package download statistics acquired from the RStudio CRAN mirror log API. Total is since October 2012.</div>
		    </div>
		  </div>

		  <p>The intraclass correlation coefficient (ICC) is a commonly used and widespread summary statistic. The ICC is a ratio of variances and measures repeatability and can also be used to assess measurement error. Both of these uses are popular across a very diverse range of scientific fields, such as: agricultural production and animal health, human health, geology, biochemistry, psychology, and ecology & evolutionary biology.</p> 

		  <p>I have created the <span class="code">R</span> package, <span class="code">ICC</span> to be used during the planning of experiments and the analysis of data to estimate the intraclass correlation coefficient (Wolak et al. 2012). The package includes functions to 1) estimate the ICC and it's associated confidence limits and 2) calculate the <em>n</em> number of individuals/groups necessary to estimate the ICC, given <em>k</em> number of observations per individual/group and a desired confidence interval width, <em>w</em>.</p>

		  <p>The current version is available for download from the <a target="_blank" href="https://cran.r-project.org/package=ICC">CRAN website</a> or the <a target="_blank" href="https://github.com/matthewwolak/ICC">package GitHub page</a>. Please give any feedback, comments, or issues using the e-mail address listed in the package or on the <a target="_blank" href="https://github.com/matthewwolak/ICC">package GitHub page</a>.</p>
 

<!-- TODO add notice/links to gists --> 





		  <h2>Explaining phenotypic resemblance among relatives</h2>

		    <h4><span class="code">R</span> package <span class="code">nadiv</span></h4>

                  <div class="left-img" style="width: auto;">
<embed src="http://cranlogs.r-pkg.org/badges/last-day/nadiv">
<br>
<embed src="http://cranlogs.r-pkg.org/badges/nadiv">
<br>
<embed src="http://cranlogs.r-pkg.org/badges/grand-total/nadiv"> 
 		    <div class="dropdown-contentL">
    		      <div class="img-desc">Package download statistics acquired from the RStudio CRAN mirror log API. Total is since October 2012.</div>
		    </div>
		  </div>

<!--                 <div class="left-img">
TODO X chromosome image
		    <img src="https://openclipart.org/download/3730/FunDraw-dot-com-Welder.svg" alt="Pardon the dust"> 
  		    <div class="dropdown-contentL">
    		      <div class="img-desc">More about methods to come</div>
		    </div>
		      <p class="img-desc">More about ...</p>
		  </div>

-->

		  <p>The <span class="code">R</span> package <span class="code">nadiv</span>, which loosely stands for (<span class="code">N</span>on-)<span class="code">AD</span>ditive <span class="code">I</span>n<span class="code">V</span>erses, was created to facilitate the estimation of additive and non-additive genetic variances using linear mixed effects models (often referred to as <em>animal models</em>). The package includes functions to compute the inverse of autosomal and sex-chromosomal additive, autosomal dominance, and autosomal epistatic (digenic) relatedness matrices from a pedigree. Other handy (<em>at least I think they're handy</em>) functions standardize some pedigree manipulation and simulation procedures.</p>

		  <p>Output from <span class="code">nadiv</span> can be used by some mixed model software programs (e.g., <a target="_blank" href="https://cran.r-project.org/package=MCMCglmm">MCMCglmm</a>, <a target="_blank" href="http://didgeridoo.une.edu.au/km/wombat.php">WOMBAT</a>, & ASReml). There are a number of other functions included in the package that are quite useful when dealing with pedigrees or running linear mixed models. For example, <span class="code">proLik()</span> constructs profile likelihoods of variance components from an ASReml-R mixed model and <span class="code">aiFun()</span> creates a (co)variance and correlatioan matrix from the sampling (co)variances of the random effects in an ASReml-R model object. Also, <span class="code">findDFC()</span> will show you which pairs of individuals in a pedigree are double first cousins as well as indicate the number of families where you get these relationships. Knowing this information is useful for understanding the extent to which models can separate the effects of maternal, environmental, and genetic (additive and non-additive) sources of trait variation in a given pedigree (e.g., Wolak & Keller 2014).</p>

		  <p>The current version is available for download from the <a target="_blank" href="https://cran.r-project.org/package=nadiv">CRAN website</a> or the <a target="_blank" href="https://github.com/matthewwolak/nadiv">package GitHub page</a>. Please give any feedback, comments, or issues using the e-mail address listed in the package or on the <a target="_blank" href="https://github.com/matthewwolak/nadiv">package GitHub page</a>.</p>








		<h4>Non-additive genetic variances</h4>

		  <p>Wolak (2012) gives explanations for some of the main functions in <span class="code">nadiv</span>. The paper includes Supplementary Information, which contains examples on how to use the output of <span class="code">nadiv</span> in the mixed model software programs: <a target="_blank" href="https://cran.r-project.org/package=MCMCglmm">MCMCglmm</a>, <a target="_blank" href="http://didgeridoo.une.edu.au/km/wombat.php">WOMBAT</a>, ASReml-R, & ASReml standalone.</p>




		<h4>Sex-linkage & Haplodiploidy</h4>

		  <p>The <span class="code">R</span> package <span class="code">nadiv</span> contains functions to construct sex-chromosomal additive genetic relatedness matrices in the case of X or Z chromosomes. The relatedness matrices are analagous to the typical numerator relationship matrix (often referred to as <b>A</b>), but reflect the covariance among relatives as a result of the different inheritance patterns of sex chromosomes as compared to the autosomes. Note that this inheritance pattern is also the same as what would be expected in haplodiploid organisms (e.g., some insects such as bees and wasps)</p>

		  <p>The functions to construct the inverse of the sex-chromosomal additive genetic relatedness matrices implement algorithms I developed<!-- TODO link to chapter of dissertation --> for different models of global sex-chromosomal dosage compensation (e.g., random X-inactivation). These algorithms are based on Fernando & Grossman (<a target="_blank" href="http://link.springer.com/journal/122/80/1/page/1">Theoretical and Applied Genetics 1990 vol. 80:75-80</a>). With these matrices, researchers can estimate sex-linked additive genetic variances using a range of mixed model software programs that allow users to supply genearlized inverse covariance matrices (i.e., <a target="_blank" href="https://cran.r-project.org/package=MCMCglmm">MCMCglmm</a>, <a target="_blank" href="http://didgeridoo.une.edu.au/km/wombat.php">WOMBAT</a>, & ASReml).</p>

		  <p>In addition, there are functions to trace the inheritance of the Y or W chromosomes and create factors to then use a mixed model to estimate the variance due to Y/W chromosomes.</p> 





		<h4>Genetic groups</h4>

		  <p>Quantitative genetic analyses using (generalized) linear mixed models and a pedigree can be expanded to account for genetic heterogeneity in the base population. Methods to account for these <em>genetic groups</em> can potentially be used to study microevolutionary change by separating genetic trends due to immigration from trends attributable to selection and/or drift. Further, these methods can reduce bias in estimates of additive genetic variance whenever pedigrees contain individuals with missing parents that do not come from the true founders of a population. These points and more are discussed in our <b><em>Journal of Animal Ecology</em></b> article and How To tutorials (<a target="_blank" href="pdf/Wolak2017HowToGeneticGroupsQGAnimalModels.pdf">Main text PDF</a> <a target="_blank" href="pdf/Wolak2017SI_HowToGeneticGroupsQGAnimalModels.pdf">Supp. Info. PDF</a>).</p>

		  <p>I have included two functions in <span class="code">nadiv</span> to standardize and enable the implementation of genetic group methods across software programs. These two functions reflect the two approaches to include genetic group effects in a model (see our paper for more explanation). Genetic groups can be included explicitly in the fixed effects portion of a mixed model using output from the <span class="code">ggcontrib()</span> function. Alternatively, genetic groups can be included implicitly in the specification of random terms by incorporating them into the inverse relatedness matrix that is linked to the additive genetic variance term. The function <span class="code">makeAinv()</span> can be used to do this second method. Additionally, both methods can incorporate <em>fuzzy classification</em> of genetic groups (see more in the <a target="_blank" href="pdf/Wolak2017SI_HowToGeneticGroupsQGAnimalModels.pdf">tutorial accompanying the How To article</a>). Finally, the <span class="code">simmGG()</span> function facilitates the simulation of pedigrees with associated data that have genetic group effects present.

<!-- TODO make/add figure of phenotypic trend (similar to figs 2&4 from Wolak & Reid 2016). -->



	




		  <h2>Estimating net genetic effects that explain differences between populations</h2>


<!-- TODO graph temporary for now -->
                <div class="right-img">
		    <img src="images/LineXGraphGeneric.png" alt="Line Cross"> 
  		    <div class="dropdown-contentR">
    		      <div class="img-desc">Line crosses between parental populations (P1 & P2) create a series of genetically distinct lines in the subsequent generations (e.g., F1 & F2), including backcrosses (e.g., B1 & B2). Expected average phenotypes in each line can be predicted from genetic models. For example, under an additive only model the line means are expected to be the same as the mid-parent value. Adding more genetic effects will yield different predicted phenotypes.</div>
		    </div>
		      <p class="img-desc">Line crosses between ...</p>
		  </div>



     
      		  <h4>Line Cross Analyses</h4>


		  <p>I am currently developing an R package to perform joint scaling tests. A joint scaling test (JST) uses the relationships between generation means of two parental populations, F1, F2, and backcrosses to estimate the magnitude and standard errors of net genetic components responsible for the differences in phenotype observed between two populations (further information in Lynch and Walsh. 1998. Genetics and Analysis of Quantitative Traits). JSTs are goodness-of-fit tests, assessed by least-squares regression, between the observed generation means and the expected generation means under a particular genetic model.</p>

		  <p>Functions in the package will include the basic joint scaling test, model averaging using an information-theoretic method (Akaike's Information Criterion), visual presentation of observed and modeled data, and a way to pick and choose modeled effects from among many genetic effects available. I will eventually have a preliminary version of the package on GitHub... Again, please send me any and all comments about what to include in this package.</p>

    		</div><!-- /.blurb -->
		</div><!-- /.container -->
		<footer>
    		<ul>
        		<li><a href="https://github.com/matthewwolak">github.com/matthewwolak</a></li>
			</ul>
		</footer>
	</body>
</html>
